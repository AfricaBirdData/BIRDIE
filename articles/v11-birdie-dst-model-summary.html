<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BIRDIE DST: Model summary • BIRDIE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BIRDIE DST: Model summary">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BIRDIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01-birdie-basics.html">BIRDIE: Basics</a></li>
    <li><a class="dropdown-item" href="../articles/v02-birdie-spp-abundance.html">BIRDIE: Species abundance</a></li>
    <li><a class="dropdown-item" href="../articles/v03-birdie-spp-distributions.html">BIRDIE: Species distributions</a></li>
    <li><a class="dropdown-item" href="../articles/v04-birdie-abu-data-prep.html">BIRDIE ABU: Data preparation</a></li>
    <li><a class="dropdown-item" href="../articles/v05-birdie-abu-model-fitting.html">BIRDIE ABU: Model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/v06-birdie-abu-model-diagnostics.html">BIRDIE ABU: Model diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/v07-birdie-abu-model-summary.html">BIRDIE ABU: Model summary</a></li>
    <li><a class="dropdown-item" href="../articles/v08-birdie-dst-data-prep.html">BIRDIE DST: Data preparation</a></li>
    <li><a class="dropdown-item" href="../articles/v09-birdie-dst-model-fitting.html">BIRDIE DST: Model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/v10-birdie-dst-diagnostics.html">BIRDIE DST: Model diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/v11-birdie-dst-model-summary.html">BIRDIE DST: Model summary</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>BIRDIE DST: Model summary</h1>
            
      

      <div class="d-none name"><code>v11-birdie-dst-model-summary.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The species distributions module (DST) of the BIRDIE pipeline has
four main steps: data preparation, model fitting, model diagnostics and
model summary. See the <em>BIRDIE: basics</em> and <em>BIRDIE: species
distributions</em> vignettes for general details about BIRDIE and about
the DST module, respectively. In this vignette, we will go through the
different tasks that are performed during the step of the DST module:
<strong>model summary</strong>.</p>
<p>The main function used for summarising a model fit is
<code><a href="../reference/ppl_summarise_occu.html">ppl_summarise_occu()</a></code>. This is a <code>ppl_</code> function,
and therefore it doesn’t do much processing itself (see <em>BIRDIE:
basics</em> if this is confusing), but it does call the right functions
to do the work.</p>
<p>This step is relatively simple. Here we need to conduct two tasks:
predict occurrence and detection probabilities for all pentads in South
Africa from a fitted model and summarise these predictions.</p>
</div>
<div class="section level2">
<h2 id="predicting-from-a-model-fit">Predicting from a model fit<a class="anchor" aria-label="anchor" href="#predicting-from-a-model-fit"></a>
</h2>
<p><code><a href="../reference/predictSpOccu.html">predictSpOccu()</a></code> is used for predicting from a model fit
and it is basically a wrapper around
<code><a href="https://www.jeffdoser.com/files/spoccupancy-web/reference/predict.PGOcc.html" class="external-link">spOccupancy::predict.PGOcc()</a></code>. However, it has a few data
preparation steps to make sure the data we pass on to the predict
function has the same variables and on the same scale as the data we
used for fitting the model. Model are fitted using only those pentads
that were visited in any given year, but we want to predict for all
pentads in South Africa. To maintain the same scale, we make use of the
covariate scale information that we stored in the model fit object (see
<em>BIRDIE DST: model fitting</em> vignette).</p>
<p>The output of <code><a href="../reference/predictSpOccu.html">predictSpOccu()</a></code> is a list with two
elements containing posterior predictive samples for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
(psi, probability of occurrence) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
(probability of detection) for each pentad.</p>
</div>
<div class="section level2">
<h2 id="summarising-predictions">Summarising predictions<a class="anchor" aria-label="anchor" href="#summarising-predictions"></a>
</h2>
<p>In this step, we use the function <code><a href="../reference/summariseSpOccu.html">summariseSpOccu()</a></code> to
extract the 0.025, 0.5 and 0.975 quantiles of the predictive samples for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
obtained from <code><a href="../reference/predictSpOccu.html">predictSpOccu()</a></code>. We will store these
quantiles to display on the BIRDIE website rather than all of the
posterior predictive samples.</p>
<p>We also compute the realized occupancy from the posterior predictive
samples and the data. The realized occupancy is the probability of
occurrence conditional on the observed data, such that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>o</mi><mi>c</mi><mi>c</mi><mi>u</mi><mo stretchy="false" form="prefix">|</mo><mi>o</mi><mi>b</mi><mi>s</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P[occu | obs = 1] = 1</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>o</mi><mi>c</mi><mi>c</mi><mi>u</mi><mo stretchy="false" form="prefix">|</mo><mi>o</mi><mi>b</mi><mi>s</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mrow><mi>ψ</mi><mi>q</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ψ</mi><mo>+</mo><mi>ψ</mi><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P[occu | obs = 0] = \frac{\psi q}{(1 - \psi + \psi q)}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">obs = 1</annotation></semantics></math>
when the species was detected at a site on any visit, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">obs = 0</annotation></semantics></math>
when the species was not detected at a site on any visit,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
is the probability of occurrence estimated by our model and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q = \prod_{i=1}^N (1 - p_i)</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>
being the probability of detection on visit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
the total number of visits to a given site.</p>
<p>All these summaries are stored in a file called
<code>analysis/output/occu_pred_spOccupancy_YYYY_sp_code.csv</code>,
where <code>YYYY</code> is the year of the data we are fitting a model
to and <code>sp_code</code> is the species code. These files will be
exported to the database for storage and display on the BIRDIE
website.</p>
<p>If no model could be fitted because of lack of enough data, then, we
use the raw data to create the prediction file mentioned above The file
still has the exact same structure, but now
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
will be <code>NA</code> for all pentads (because they could not be
calculated). Raw data will be treated as realized occupancy and no
confidence limits will be estimated. The function that performs these
tasks is <code><a href="../reference/createPredFromAbap.html">createPredFromAbap()</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by BIRDIE Development Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
