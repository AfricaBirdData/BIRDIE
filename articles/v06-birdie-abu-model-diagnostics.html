<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BIRDIE">
<title>BIRDIE ABU: Model diagnostics • BIRDIE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BIRDIE ABU: Model diagnostics">
<meta property="og:description" content="BIRDIE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BIRDIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v01-birdie-basics.html">BIRDIE: Basics</a>
    <a class="dropdown-item" href="../articles/v02-birdie-spp-abundance.html">BIRDIE: Species abundance</a>
    <a class="dropdown-item" href="../articles/v03-birdie-spp-distributions.html">BIRDIE: Species distributions</a>
    <a class="dropdown-item" href="../articles/v04-birdie-abu-data-prep.html">BIRDIE ABU: Data preparation</a>
    <a class="dropdown-item" href="../articles/v05-birdie-abu-model-fitting.html">BIRDIE ABU: Model fitting</a>
    <a class="dropdown-item" href="../articles/v06-birdie-abu-model-diagnostics.html">BIRDIE ABU: Model diagnostics</a>
    <a class="dropdown-item" href="../articles/v07-birdie-abu-model-summary.html">BIRDIE ABU: Model summary</a>
    <a class="dropdown-item" href="../articles/v08-birdie-dst-data-prep.html">BIRDIE DST: Data preparation</a>
    <a class="dropdown-item" href="../articles/v09-birdie-dst-model-fitting.html">BIRDIE DST: Model fitting</a>
    <a class="dropdown-item" href="../articles/v10-birdie-dst-diagnostics.html">BIRDIE DST: Model diagnostics</a>
    <a class="dropdown-item" href="../articles/v11-birdie-dst-model-summary.html">BIRDIE DST: Model summary</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>BIRDIE ABU: Model diagnostics</h1>
            
      
      
      <div class="d-none name"><code>v06-birdie-abu-model-diagnostics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The species abundance module (ABU) of the BIRDIE pipeline has four
main steps: data preparation, model fitting, model diagnostics and model
summary. See the <em>BIRDIE: basics</em> and <em>BIRDIE: species
abundance</em> vignettes for general details about BIRDIE and about the
DST module, respectively. In this vignette, we will go through the
different tasks that are performed during the step of the DST module:
<strong>model diagnostics</strong>.</p>
<p>The main function used for model diagnosis is
<code><a href="../reference/ppl_diagnose_ssm.html">ppl_diagnose_ssm()</a></code>. This is a <code>ppl_</code> function,
and therefore it doesn’t do much processing itself (see <em>BIRDIE:
basics</em> if this is confusing), but it does call the right functions
to do the work.</p>
<p>During the diagnostics step we look at two indicators: the
Gelman-Rubin convergence diagnostic (<span class="math inline">\(\hat{R}\)</span>) and a goodness-of-fit Bayesian
p-value. The first diagnostic is computed by the function
<code><a href="../reference/diagnoseRhatJagsSsm.html">diagnoseRhatJagsSsm()</a></code> and the second one by the function
<code><a href="../reference/diagnoseGofJagsSsm.html">diagnoseGofJagsSsm()</a></code> (both functions are found in
<code>R/utils-jags.R</code>).</p>
<p><code><a href="../reference/ppl_diagnose_ssm.html">ppl_diagnose_ssm()</a></code> combines the output of these two
functions into a single table that is stored in
<code>analysis/output/sp_code/abu_diagnostics_spOccupancy_YYYY_sp_code.csv</code>,
where <code>YYYY</code> is the year of the data we are fitting a model
to and <code>sp_code</code> is the species code. In this way, it is easy
to extract all diagnostic files from the different directories, combine
them into a table and quickly explore potential issues.</p>
</div>
<div class="section level2">
<h2 id="diagnosing-convergence">Diagnosing convergence<a class="anchor" aria-label="anchor" href="#diagnosing-convergence"></a>
</h2>
<p>The function <code><a href="../reference/diagnoseRhatJagsSsm.html">diagnoseRhatJagsSsm()</a></code> extracts <span class="math inline">\(\hat{R}\)</span> values computed by
<code>JAGS</code> for each of the estimated parameters and tabulates
them. In this table, each parameter appears in one column and gets a 0
if <span class="math inline">\(|1 - \hat{R}| &lt; 0.1\)</span> and a 1
otherwise. Some extra columns are added, such as number of
non-convergent parameters, number of detections observed, number of
observations, etc.</p>
</div>
<div class="section level2">
<h2 id="diagnosing-goodness-of-fit">Diagnosing goodness-of-fit<a class="anchor" aria-label="anchor" href="#diagnosing-goodness-of-fit"></a>
</h2>
<p>The function <code><a href="../reference/diagnoseGofJagsSsm.html">diagnoseGofJagsSsm()</a></code> conducts posterior
predictive checks (PPC) and calculates a Bayesian p-value.</p>
<p>The procedure consists of simulating a number of count data sets from
the posterior distribution and comparing them with the observed
data.</p>
<p>We calculate the mean and standard deviation for each of the
simulated data sets. Then, we calculate the number of data sets that are
below and above the mean observed in the data (“Tmean”). If we obtain
proportions close to 0.5 it means that our predictions are unbiased. We
follow a similar procedure with the standard deviations (“Tsd”) to see
if our predictions have a similar dispersion as that observed in the
data. Finally, for each simulation we calculate the mean difference
observed with the data (“Tdiff”), which should give us an idea of the
magnitude of the bias, should it exist.</p>
</div>
<div class="section level2">
<h2 id="diagnosing-uncertainty">Diagnosing uncertainty<a class="anchor" aria-label="anchor" href="#diagnosing-uncertainty"></a>
</h2>
<p>Streamlined analyses can be difficult to stabilize for all species
and sites. Sometimes state estimate uncertainty can grow quickly,
particularly in long periods with missing data at the beginning and end
of the time series. We are particularly concerned with uncertainty
exploding towards recent years, because this can impact managers and
decision makers. Therefore, we test whether the upper limit of the
confidence band estimated for the last 10 years ever gets higher than 50
times the highest estimate for that period, at any site for any species.
If this is the case we exclude estimates and uncertainty bands for those
sites and species combinations. We still present counts.</p>
<p>The function <code><a href="../reference/ppl_diagnose_ssm.html">ppl_diagnose_ssm()</a></code> identifies for each
species what sites present large uncertainty at the end of the time
series and stores them in the diagnostics file. This information will
then be used by the summary function to exclude the corresponding
estimates.</p>
</div>
<div class="section level2">
<h2 id="shiny-apps">Shiny apps<a class="anchor" aria-label="anchor" href="#shiny-apps"></a>
</h2>
<p>We have developed a Shiny app that allows us to extract diagnostics
for any species and year and explore them in an interactive way. The app
is still experimental and can be found at
<code>analysis/tools/diagnose_dabu</code></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by BIRDIE Development Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
