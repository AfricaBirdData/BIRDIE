<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BIRDIE ABU: Model fitting • BIRDIE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BIRDIE ABU: Model fitting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BIRDIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01-birdie-basics.html">BIRDIE: Basics</a></li>
    <li><a class="dropdown-item" href="../articles/v02-birdie-spp-abundance.html">BIRDIE: Species abundance</a></li>
    <li><a class="dropdown-item" href="../articles/v03-birdie-spp-distributions.html">BIRDIE: Species distributions</a></li>
    <li><a class="dropdown-item" href="../articles/v04-birdie-abu-data-prep.html">BIRDIE ABU: Data preparation</a></li>
    <li><a class="dropdown-item" href="../articles/v05-birdie-abu-model-fitting.html">BIRDIE ABU: Model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/v06-birdie-abu-model-diagnostics.html">BIRDIE ABU: Model diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/v07-birdie-abu-model-summary.html">BIRDIE ABU: Model summary</a></li>
    <li><a class="dropdown-item" href="../articles/v08-birdie-dst-data-prep.html">BIRDIE DST: Data preparation</a></li>
    <li><a class="dropdown-item" href="../articles/v09-birdie-dst-model-fitting.html">BIRDIE DST: Model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/v10-birdie-dst-diagnostics.html">BIRDIE DST: Model diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/v11-birdie-dst-model-summary.html">BIRDIE DST: Model summary</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>BIRDIE ABU: Model fitting</h1>
            
      

      <div class="d-none name"><code>v05-birdie-abu-model-fitting.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://africabirddata.github.io/BIRDIE/">BIRDIE</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The species abundance module (ABU) of the BIRDIE pipeline has four
main steps: data preparation, model fitting, model diagnostics and model
summary. See the <em>BIRDIE: basics</em> and <em>BIRDIE: species
abundance</em> vignettes for general details about BIRDIE and about the
ABU module, respectively. In this vignette, we will go through the
different tasks that are performed during the first step of the ABU
module: <strong>data preparation</strong>.</p>
<p>The main function used for model fitting is
<code><a href="../reference/ppl_fit_ssm_model.html">ppl_fit_ssm_model()</a></code>. This is a <code>ppl_</code> function,
and therefore it doesn’t do much processing itself (see <em>BIRDIE:
basics</em> if this is confusing), but it does call the right functions
to do the work. The output of <code><a href="../reference/ppl_fit_ssm_model.html">ppl_fit_ssm_model()</a></code> is always
a model fit but it will change depending on the package we have selected
in the <code><a href="../reference/configPipeline.html">configPipeline()</a></code> function. At moment, there is only
one option, and it is to fit a state-space model using JAGS (with the
package <code>jagsUI</code>).</p>
<p>In the following section, we explain the process of fitting a model
using <code>jagsUI</code>.</p>
</div>
<div class="section level2">
<h2 id="fitting-a-model-using-the-jagsui-package">Fitting a model using the <code>jagsUI</code> package<a class="anchor" aria-label="anchor" href="#fitting-a-model-using-the-jagsui-package"></a>
</h2>
<p>At the moment there is only the option of fitting a state-space model
using the <code>jagsUI</code> package and therefore it is the main
<code><a href="../reference/ppl_fit_ssm_model.html">ppl_fit_ssm_model()</a></code> that takes care of this (i.e., there is
no package specific function for fitting the model - although we might
want to change this).</p>
<p>We use the <code><a href="https://kenkellner.com/jagsUI/reference/jagsbasic.html" class="external-link">jagsUI::jags.basic()</a></code> function, which outputs
raw <code>mcmc</code> samples. These outputs use less memory than the
default <code>jagsUI</code> processed outputs that compute some
additional elements, such posterior means and standard deviations.</p>
<p>We do compute those additional elements when we need them, using the
custom function <code><a href="../reference/processJAGSoutput.html">processJAGSoutput()</a></code>, which is very similar
to the internal <code>jagsUI:::processoutput()</code>. It has just been
slightly modified to remove some calculations that we don’t need and
make computations a bit lighter. This function and all other that are
design to work with JAGS are stored in the <code>R/utils-jags.R</code>
file.</p>
</div>
<div class="section level2">
<h2 id="latest-model-specification">Latest model specification<a class="anchor" aria-label="anchor" href="#latest-model-specification"></a>
</h2>
<p>State-space models are used to describe and understand dynamic
systems that may not be perfectly observed. Within this framework, we
consider waterbird abundance to be a process that evolves over time, and
which we observe during visits to CWAC sites. However, counts conducted
by observers are distorted by imperfect detection that translates into
counting errors. By counting repeatedly over time, and assuming that
abundance evolves smoothly over time compared to observation error, we
can disentangle these two processes.</p>
<p>We consider that the log of the observed counts
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>)
at sampling occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
(generally there were two sampling occasions per year, one in mid-summer
and one in mid-winter), at any given site, arise from a normal
distribution, such that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log{(y_i)} \sim N(\mu_i, \sigma_i^2)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math>is
the latent (unobserved) log abundance of waterbirds present at a site on
sampling occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
is the corresponding variance of the observers counting error, also in
the log scale. Therefore, counts depend both on the number of waterbirds
present on site, and on errors in the counts of these birds.</p>
<p>To model changes in waterbird abundance between the two-seasons of
year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
we define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mi>t</mi></msub><annotation encoding="application/x-tex">s_t</annotation></semantics></math>
to be the summer abundance and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>t</mi></msub><annotation encoding="application/x-tex">w_t</annotation></semantics></math>
the winter abundance. Note that, although we currently consider only one
count per season, there could potentially be multiple counts in a single
year and season. However, the underlying true abundance is considered to
stay constant in any given year and season (for clarity, note also that
while sampling occasions were indexed by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
years are indexed by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>).
Thus, the expected (log) abundance for any given count can be written
as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mtext mathvariant="normal">summer</mtext><mo>+</mo><msub><mi>w</mi><mi>t</mi></msub><mtext mathvariant="normal">winter</mtext></mrow><annotation encoding="application/x-tex">\mu_{i} = s_t \textrm{summer} + w_t \textrm{winter}</annotation></semantics></math></p>
<p>where ‘summer’ is an indicator variable that takes on the value 1 in
summer and 0 in winter, and ‘winter’ is the opposite. We then define
abundance dynamics as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>β</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t = s_{t-1} + \beta_t</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>+</mo><msub><mi>ξ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">w_t = s_t + \xi_t</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\beta_t</annotation></semantics></math>
corresponds to the change in summer abundance from year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math>
to year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\xi_t</annotation></semantics></math>
is the difference between summer and winter abundance, both in the log
scale. If exponentiated, these parameters can be interpreted as the rate
of change in the population and the winter-to-summer ratio of the
population, respectively.</p>
<p>We impose relatively smooth changes in abundance by defining
autocorrelation in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\beta_t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\xi_t</annotation></semantics></math>
terms over time. In addition, we define a mean reverting process whereby
the populations at a certain site tend to revert to a site-specific mean
or “preferred” abundance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\psi_{(s)t}</annotation></semantics></math>
in summer and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mrow><mi>w</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\psi_{wt}</annotation></semantics></math>
in winter. This specification is important to prevent estimated
populations to explode in periods with missing data. These mean
abundances may change occasionally, as we will see below.</p>
<p>We then define the expected change in summer population (the winter
population evolves similarly) as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ζ</mi><mi>t</mi></msub><mi>′</mi><mo>=</mo><msub><mi>ψ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\zeta_t' = \psi_{(s)t} - s_t</annotation></semantics></math>
We define certain persistence in population trends such that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><msub><mi>ϕ</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ζ</mi><mi>t</mi></msub><mi>′</mi><mo>−</mo><msub><mi>β</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ζ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\beta_{t+1} = \beta_t + \phi_s(\zeta_t' - \beta_t) + \zeta_t</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ζ</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>ζ</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\zeta_t \sim N(0, \sigma_{\zeta}^2)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\phi_s</annotation></semantics></math>
lies between zero and one, and controls how quickly the population
reverts back to the mean.</p>
<p>Finally, we define a jump process, whereby population can present
sudden changes in abundance that do not conform to the general temporal
pattern. These changes are frequent in waterbird populations and,
although possibly associated the conditions at the sites, it is
challenging to understand the drivers behind them. We define</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">jump</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mtext mathvariant="normal">I</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><msub><mi>z</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\textrm{jump}_{(s)t} = \textrm{I}_{(s)t}z_{(s)t}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">I</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{I}_{(s)t} \sim \textrm{Bernoulli}(p_s)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mrow><mi>j</mi><mi>u</mi><mi>m</mi><msub><mi>p</mi><mi>s</mi></msub></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z_{(s)t} \sim N(0, \sigma_{jump_s}^2)</annotation></semantics></math>.
We make
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>s</mi></msub><annotation encoding="application/x-tex">p_s</annotation></semantics></math>
be a small probability (with its prior) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>j</mi><mi>u</mi><mi>m</mi><msub><mi>p</mi><mi>s</mi></msub></mrow></msub><annotation encoding="application/x-tex">\sigma_{jump_s}</annotation></semantics></math>
large relative to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>ζ</mi></msub><annotation encoding="application/x-tex">\sigma_{\zeta}</annotation></semantics></math>
to favour few, large jumps rather than frequent small ones.</p>
<p>These jumps in the population may stick for some time, meaning that
they affect the mean abundance of the sites. Therefore, once a jump in a
population is observed, the new level becomes the mean and we need a new
jump to go back to the original mean. In this way we ensure that
deviating from the mean and coming back to it are captured as two
separate jumps and not necessarily as a jump and a mean reversion.
Therefore,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>ψ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>+</mo><msub><mtext mathvariant="normal">jump</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\psi_{(s)t+1} = \psi_{(s)t} + \textrm{jump}_{(s)t}</annotation></semantics></math>
In order to capture population jumps in the changes represented by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
we set</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>t</mi></msub><mo>=</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><msub><mtext mathvariant="normal">jump</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\beta_{t} = \beta_{t} + \textrm{jump}_{(s)t}</annotation></semantics></math></p>
<p>Note that this is for reporting purposes only, which is important
because we don’t want jumps to be considered in the update step for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\beta_t</annotation></semantics></math>
(see expression above for _{t+1}).</p>
<p>The model for the winter population is similar to the summer one</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>t</mi></msub><mi>′</mi><mo>=</mo><msub><mi>ψ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\xi_t' = \psi_{(w)t} - s_{t+1}</annotation></semantics></math></p>
<p>represents the expected change in winter population on year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t+1</annotation></semantics></math>,
and the actual change is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>λ</mi><mi>t</mi></msub><mo>+</mo><msub><mi>ϕ</mi><mi>w</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mi>t</mi></msub><mi>′</mi><mo>−</mo><msub><mi>λ</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ξ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_{t+1} = \lambda_t + \phi_w(\xi_t' - \lambda_t) + \xi_t</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>ξ</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi_t \sim N(0, \sigma_{\xi}^2)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">\phi_w</annotation></semantics></math>
lies between zero and one, and controls how quickly the population
reverts back to the mean.</p>
<p>There can also be jumps in the winter populations given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">jump</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>=</mo><msub><mtext mathvariant="normal">I</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><msub><mi>z</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\textrm{jump}_{(w)t} = \textrm{I}_{(w)t}z_{(w)t}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">I</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>w</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{I}_{(w)t} \sim \textrm{Bernoulli}(p_w)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mrow><mi>j</mi><mi>u</mi><mi>m</mi><msub><mi>p</mi><mi>w</mi></msub></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z_{(w)t} \sim N(0, \sigma_{jump_w}^2)</annotation></semantics></math>.
We make
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>w</mi></msub><annotation encoding="application/x-tex">p_w</annotation></semantics></math>
be a small probability (with its prior) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>j</mi><mi>u</mi><mi>m</mi><msub><mi>p</mi><mi>s</mi></msub></mrow></msub><annotation encoding="application/x-tex">\sigma_{jump_s}</annotation></semantics></math>
large relative to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>ξ</mi></msub><annotation encoding="application/x-tex">\sigma_{\xi}</annotation></semantics></math>.</p>
<p>These jumps may also stick to the population as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>ψ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub><mo>+</mo><msub><mtext mathvariant="normal">jump</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\psi_{(w)t+1} = \psi_{(w)t} + \textrm{jump}_{(w)t}</annotation></semantics></math>
And they are incorporated into
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\lambda_t</annotation></semantics></math>
for reporting purposes, such that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>λ</mi><mi>t</mi></msub><mo>+</mo><msub><mtext mathvariant="normal">jump</mtext><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{t} = \lambda_{t} + \textrm{jump}_{(w)t}</annotation></semantics></math></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by BIRDIE Development Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
